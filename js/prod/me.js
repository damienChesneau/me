function showModal(){$("#myModal").modal("show")}function ajaxRequest(e){$.ajax({url:"ajaxDialog.php?id="+e,type:"GET",dataType:"text",/*timeout:1e3,*/error:function(){alert("PB")},success:function(e){document.getElementById("inner").innerHTML=e;showModal()}})}function ajaxConnection(){setNewErrorMessage("");var e=$("#email").val();if(!emailValidate(e)){$("#message").text("Le email inscrit n'est pas sous le bon format.")}else{var t=$("#mdp").val();$.ajax({url:"AjaxConnexion.php?email="+e+"&mdp="+t,type:"GET",dataType:"text",/*timeout:1e3,*/error:function(){$("#message").text("Une erreur est survenu.")},success:function(e){if(e.indexOf("OK")!==-1){setNewSuccessMessage("Connexion authorisé.");document.location="./"}else if(e.indexOf("ERREUR")!==-1){setNewErrorMessage("Connexion refusé.")}}})}}function ajaxVerifIfConnected(){$.ajax({url:"ajaxVerifyIfConnected.php",type:"GET",dataType:"text",/*timeout:1e3,*/error:function(){document.location="./"},success:function(e){}})}function setNewInfoMessage(e){$("#message").text(e)}function setNewSuccessMessage(e){document.getElementById("message").style.color="green";$("#message").text(e)}function setNewErrorMessage(e){document.getElementById("message").style.color="red";$("#message").text(e)}function ajaxDeconnection(){$.ajax({url:"AjaxDeconnection.php",type:"POST",dataType:"text",/*timeout:1e3,*/error:function(){$("#message").text("Une erreur est survenu.")},success:function(e){document.location="./"}})}function emailValidate(e){var t=e.indexOf("@");var n=e.lastIndexOf(".");if(t<1||n<t+2||n+2>=e.length){return false}else{return true}}function getGestionPortfolio(){$.ajax({url:"gestionPortfolio.php",type:"GET",dataType:"text",/*timeout:1e3,*/error:function(){},success:function(e){$("#content").html(e);deselectAll();document.getElementById("gestionPortfolioLink").className="list-group-item active"}})}function getGestionCarte(){$.ajax({url:"gestionCarte.php",type:"GET",dataType:"text",/*timeout:1e3,*/error:function(){},success:function(e){$("#content").html(e);deselectAll();document.getElementById("gestionCarteLink").className="list-group-item active"}})}function getGestionUtlisateurs(){$.ajax({url:"gestionUtilisateurs.php",type:"GET",dataType:"text",/*timeout:1e3,*/error:function(){},success:function(e){$("#content").html(e);deselectAll();document.getElementById("gestionUtilisateursLink").className="list-group-item active"}})}function deselectAll(){document.getElementById("gestionPortfolioLink").className="list-group-item";document.getElementById("gestionUtilisateursLink").className="list-group-item";document.getElementById("gestionCarteLink").className="list-group-item"}function validerUtilisateur(){var e=$("#prenom").val();var t=$("#nom").val();var n=$("#email").val();var r=$("#mdp").val();var i=$("#mdp2").val();var s="";if(r==i){if(emailValidate(n)){$.ajax({url:"ajaxAjoutUtilisateur.php?prenom="+e+"&nom="+t+"&email="+n+"&mdp="+r,type:"GET",dataType:"text",/*timeout:1e3,*/error:function(){setNewErrorMessageUtlisateur("Une erreur est survenu.")},success:function(r){if(!r.indexOf("ERROR")!==-1){var i=document.getElementById("tableauUtilisateurs");var s=i.insertRow(i.rows.length);var o=s.insertCell(0);var u=s.insertCell(1);var a=s.insertCell(2);var f=s.insertCell(3);var l=s.insertCell(4);o.innerHTML=e;u.innerHTML=t;a.innerHTML=n;f.innerHTML='<a onclick="modifierUser('+r+',this.parentNode)"><img src="../img/modifier-icon.png"></img></a>';l.innerHTML='<a onclick="deleteUser('+r+')"><img src="../img/delete-icon.png"></img></a>'}else{setNewErrorMessageUtlisateur("Une erreur est survenu lors de l'ajout.")}}})}else{setNewErrorMessageUtlisateur("L'adresse email n'est pas au bon format.")}}else{setNewErrorMessageUtlisateur("Les deux mots de passes ne correspondent pas.")}}function setNewInfoMessageUtlisateur(e){$("#messageUtilsateur").text(e)}function setNewSuccessMessageUtlisateur(e){document.getElementById("messagemessageUtilsateur").style.color="green";$("#messageUtilsateur").text(e)}function setNewErrorMessageUtlisateur(e){document.getElementById("messageUtilsateur").style.color="red";$("#messageUtilsateur").text(e)}function deleteUser(e,t){$.ajax({url:"ajaxDelete.php?id="+e,type:"GET",dataType:"text",/*timeout:1e3,*/error:function(){setNewErrorMessageUtlisateur("Une erreur est survenu.")},success:function(e){if(e.indexOf("OK")!==-1){t.parentNode.remove()}if(e.indexOf("ERROR")!==-1){setNewErrorMessageUtlisateur("Une erreur est survenu lors de l'ajout.")}}})}function modifierUser(e,t){if(!isInUpdate){isInUpdate=true;idSelectedToUpdate=e;var n=$("#tabSupprimer"+e).html('<a onclick="annuler('+e+');">Annuler</a>');var r=$("#prenom"+e).text();var i=$("#nom"+e).text();var s=$("#email"+e).text();var o=$("#tabprenom"+e).html('<input id="inputprenom'+e+'" type="text" value="'+r+'"/>');var o=$("#tabnom"+e).html('<input id="inputnom'+e+'" type="text" value='+i+"></input>");var u=$("#tabemail"+e).html('<input id="inputemail'+e+'" type="text" value='+s+"></input>")}else{var a=$("#inputprenom"+e).val();var f=$("#inputnom"+e).val();var l=$("#inputemail"+e).val();$.ajax({url:"ajaxUpdateUser.php?id="+e+"&prenom="+a+"&nom="+f+"&email="+l,type:"GET",dataType:"text",/*timeout:1e3,*/error:function(){setNewErrorMessageListeUtilisateurs("Une erreur est survenu.")},success:function(t){if(t.indexOf("OK")!==-1){var n=$("#tabprenom"+e).html('<p id="prenom'+e+'">'+a+"</p>");var n=$("#tabnom"+e).html('<p id="nom'+e+'">'+f+"</p>");var r=$("#tabemail"+e).html('<p id="email'+e+'">'+l+"</p>");var i=$("#tabSupprimer"+e).html('<a onclick="deleteUser('+e+',this.parentNode)"><img src="../img/delete-icon.png"></img></a>');setNewSuccessMessageListeUtilisateurs("Modification bien éffectué.");window.setTimeout(setNewSuccessMessageListeUtilisateurs(""),3e3)}else if(t.indexOf("ERROR")!==-1){setNewErrorMessageListeUtilisateurs("Une erreur est survenu lors de la modification.")}}});isInUpdate=false}}function annuler(e){var t=$("#inputprenom"+e).val();var n=$("#inputnom"+e).val();var r=$("#inputemail"+e).val();var i=$("#tabprenom"+e).html('<p id="prenom'+e+'">'+t+"</p>");var i=$("#tabnom"+e).html('<p id="nom'+e+'">'+n+"</p>");var s=$("#tabemail"+e).html('<p id="email'+e+'">'+r+"</p>");var o=$("#tabSupprimer"+e).html('<a onclick="deleteUser('+e+',this.parentNode)"><img src="../img/delete-icon.png"></img></a>');idSelectedToUpdate="";isInUpdate=false}function setNewMessageListeUtilisateurs(e){$("#messageListeUtilisateurs").text(e)}function setNewSuccessMessageListeUtilisateurs(e){document.getElementById("messageListeUtilisateurs").style.color="green";$("#messageListeUtilisateurs").text(e)}function setNewErrorMessageListeUtilisateurs(e){document.getElementById("messageListeUtilisateurs").style.color="red";$("#messageListeUtilisateurs").text(e)}function sleep(e){var t=(new Date).getTime();while((new Date).getTime()<t+e);}function deleteProjet(e,t){$.ajax({url:"ajaxDeleteProject.php?id="+e,type:"GET",dataType:"text",/*timeout:1e3,*/error:function(){setNewErrorMessageListeProjets("Une erreur est survenu.")},success:function(e){if(e.indexOf("OK")!==-1){t.parentNode.remove()}else{setNewErrorMessageListeProjets("Une erreur est survenu lors de la suppression.")}}})}function setNewMessageListeProjets(e){$("#messageListeProjets").text(e)}function setNewSuccessMessageListeProjets(e){document.getElementById("messageListeProjets").style.color="green";$("#messageListeProjets").text(e)}function setNewErrorMessageListeProjets(e){document.getElementById("messageListeProjets").style.color="red";$("#messageListeProjets").text(e)}function validerProjet(){var e="";var t="";var n=new Array;var r=new Array;for(i=1;i<nb+1;i++){var s="file"+i;var o="descriptionFile"+i;var u=$("#"+s).val();var a="C:\\fakepath\\";u=u.substring(12,u.lenght);var f=$("#"+o).val();t+="&"+o+"="+f;e+="&"+s+"="+u;n[i-1]=u;r[i-1]=f}var l=$("#description").val();var c=$("#titre").val();$.ajax({url:"ajaxAddProjet.php?nb="+nb+e+t+"&titre="+c+"&description="+l,type:"POST",data:{nb:nb,queryFile:n,queryDescription:r,titre:c,description:l},dataType:"text",/*timeout:1e3,*/error:function(){setNewErrorMessageListeProjets("Une erreur est survenu.")},success:function(e){var t=e;if(e.indexOf("ERROR")!==-1){setNewErrorMessageListeProjets("Une erreur est survenu lors de l'ajout.")}else{setNewSuccessMessageListeProjets("Projet bien ajouté !");$("#description").val("");$("#titre").val("");$("#divImagesProjet").html('<div class="form-group"><label for="file1" class="col-sm-2 control-label">Image</label><div class="col-sm-10"><input type="file" class="form-control" name="file1" id="file1" placeholder="Image "><div class="input-group" ><input id="descriptionFile1" class="form-control" placeholder="Description" type="text" /><span onclick="moreImg();" class="input-group-addon">+</span></div></div></div>');if(l.length>205){var n=l.length-205;l=l.substr(0,80);l=l+" (...)"}$("#tableauProjets > tbody:last").append('<tr><td id="tabtitre'+t+'"><p id="titre'+t+'">'+c+'</p></td><td id="tabdescription'+t+'"><p id="description'+t+'">'+l+'</p></td><td id="tabModifier'+t+'"><a id="modifier'+t+'" onclick="modifierProjet('+t+',this.parentNode)"><img src="../img/modifier-icon.png"></img></a></td>            <td id="tabSuppression'+t+'"><a onclick="deleteProjet('+t+',this.parentNode);" id="suppression'+t+'"><img src="../img/delete-icon.png"></img></a></td><tr>')}}})}function moreImg(){nb++;var e=$("#divImagesProjet").html();$("#divImagesProjet").append('<div class="form-group"><label for="file'+nb+'" class="col-sm-2 control-label">Image '+nb+'</label><div class="col-sm-10"><input type="file" class="form-control" name="file'+nb+'" id="file'+nb+'" placeholder="Image "><div class="input-group" ><input id="descriptionFile'+nb+'" class="form-control" placeholder="Description" type="text" /><span onclick="moreImg();" class="input-group-addon">+</span></div></div></div>')}function modifierProjet(e,t){titreUp=$("#titre"+e).text();descriptionUp=$("#description"+e).html();if(!isProjetInUpdate){$.ajax({url:"ajaxGetProjectDescription.php",type:"POST",data:{id:e},dataType:"text",/*timeout:1e3,*/error:function(){setNewErrorMessageListeProjets("Une erreur est survenu.")},success:function(t){isProjetInUpdate=true;idProjetSelectedToUpdate=e;var n=$("#tabSuppression"+e).html('<a onclick="annulerProjet('+e+');">Annuler</a>');var r=t;var i=$("#tabtitre"+e).html('<input id="inputtitre'+e+'" type="text" value="'+titreUp+'"/>');var s=$("#tabdescription"+e).html('<textarea cols="60" rows="5" id="inputdescription'+e+'" type="text" >'+r+"</textarea>")}})}else{var n=$("#inputtitre"+e).val();var r=$("#inputdescription"+e).val();$.ajax({url:"ajaxMethods/updateProject.php",type:"POST",data:{id:e,titre:n,description:r},dataType:"text",/*timeout:1e3,*/error:function(){setNewErrorMessageListeProjets("Une erreur est survenu.")},success:function(t){if(!t.indexOf("ERROR")!==-1){var i=$("#tabtitre"+e).html('<p id="titre'+e+'">'+n+"</p>");if(r.length>205){var s=r.length-205;r=r.substr(0,80);r=r+" (...)"}var o=$("#tabdescription"+e).html('<p id="description'+e+'">'+r+"</p>");var u=$("#tabSupprimer"+e).html('<a onclick="deleteProjet('+e+',this.parentNode);" id="suppression'+e+'"><img src="../img/delete-icon.png"></img></a>');idProjetSelectedToUpdate="";isProjetInUpdate=false;setNewSuccessMessageListeProjets("Modification bien éffectué.");window.setTimeout(setNewSuccessMessageListeUtilisateurs(""),3e3)}else{setNewErrorMessageListeUtilisateurs("Une erreur est survenu lors de la modification.")}}});isProjetInUpdate=false}}function annulerProjet(e){var t=$("#tabtitre"+e).html('<p id="titre'+e+'">'+titreUp+"</p>");var n=$("#tabdescription"+e).html('<p id="description'+e+'">'+descriptionUp+"</p>");var r=$("#tabSuppression"+e).html('<a onclick="deleteProjet('+e+',this.parentNode); " id="suppression'+e+'"><img src="../img/delete-icon.png"></img></a>');idProjetSelectedToUpdate="";isProjetInUpdate=false}function maPosition(e){var t="Position déterminée :\n";t+="Latitude : "+e.coords.latitude+"\n";t+="Longitude: "+e.coords.longitude+"\n";t+="Altitude : "+e.coords.altitude+"\n";document.getElementById("infoposition").innerHTML=t}function showModalGeolocalisation(){$("#myModal2").modal("show")}function geolocalisationGetDialog(e){$.ajax({url:"ajaxMethods/ajaxDialogGeolocalisation.php",type:"POST",dataType:"text",/*timeout:1e3,*/error:function(){setNewErrorMessageListeLocalisation("Un problème est survenu.")},success:function(e){document.getElementById("inner").innerHTML=e;showModalGeolocalisation()}})}function validerLocalisation(){var e=$("#nom").val();var t=$("#longitude").val();var n=$("#latitude").val();var r=$("#active").is(":checked");$.ajax({url:"ajaxMethods/ajaxAddLocalisation.php",type:"POST",dataType:"text",data:{nom:e,longitude:t,latitude:n,isActive:r},/*timeout:1e3,*/error:function(){setNewErrorMessageListeLocalisation("Un problème est survenu l'ajout n'a pas été effectué.")},success:function(i){if(!i.indexOf("ERROR")!==-1){var s="";setNewSuccessMessageListeLocalisation("La localisation a bien été ajoutée.");if(r){document.getElementById("star").parentNode.innerHTML='<img height="20" src="../img/add-icon.png"></img>';$("#tableauLocalisations > tbody:last").append('<tr><td id="tabchoisi'+i+'"><p id="choisi'+i+'"><img id="star" height="20" src="../img/star-icon.png"></img></p></td>\n                <td id="tabnom'+i+'"><p id="nom'+i+'">'+e+'</p></td>\n\\n                <td id="tablongitude'+i+'"><p id="longitude'+i+'">'+t+'</p></td>\n                <td id="tablatitude'+i+'"><p id= "latitude'+i+'">'+n+'</p></td>\n                <td><a onclick="modifierLocalisation('+i+',this.parentNode)"><img src="../img/modifier-icon.png"></img></a></td>\n                <td id="tabSupprimer'+i+'"><a onclick="deleteLocalisation('+i+',this.parentNode)"><img src="../img/delete-icon.png"></img></a></td>\n        </tr>')}else{$("#tableauLocalisations > tbody:last").append('<tr><td id="tabchoisi'+i+'"><p id="choisi'+i+'"><img height="20" src="../img/add-icon.png"></img></p></td>\n                <td id="tabnom'+i+'"><p id="nom'+i+'">'+e+'</p></td>\n\\n                <td id="tablongitude'+i+'"><p id="longitude'+i+'">'+t+'</p></td>\n                <td id="tablatitude'+i+'"><p id= "latitude'+i+'">'+n+'</p></td>\n                <td><a onclick="modifierLocalisation('+i+',this.parentNode)"><img src="../img/modifier-icon.png"></img></a></td>\n                <td id="tabSupprimer'+i+'"><a onclick="deleteLocalisation('+i+',this.parentNode)"><img src="../img/delete-icon.png"></img></a></td>\n        </tr>')}}else{setNewErrorMessageListeLocalisation("Un problème est survenu lors de l'ajout de la localisation.")}}})}function setNewMessageListeLocalisation(e){$("#messageListeLocalisation").text(e)}function setNewSuccessMessageListeLocalisation(e){document.getElementById("messageListeLocalisation").style.color="green";$("#messageListeLocalisation").text(e)}function setNewErrorMessageListeLocalisation(e){document.getElementById("messageListeLocalisation").style.color="red";$("#messageListeLocalisation").text(e)}function deleteLocalisation(e,t){$.ajax({url:"ajaxMethods/ajaxDeleteLocalisation.php",type:"POST",dataType:"text",data:{id:e},/*timeout:1e3,*/error:function(){setNewErrorMessageListeLocalisation("Une erreur est survenu.")},success:function(e){if(e.indexOf("OK")!==-1){t.parentNode.remove()}else{setNewErrorMessageListeLocalisation("Une erreur est survenu lors de la suppression.")}}})}function updateSelectedLocalisation(e,t){$.ajax({url:"ajaxMethods/ajaxUpdateSelectedLocalisation.php",type:"POST",dataType:"text",data:{id:e},/*timeout:1e3,*/error:function(){setNewErrorMessageListeLocalisation("Une erreur est survenu.")},success:function(e){if(e.indexOf("OK")!==-1){document.getElementById("star").parentNode.innerHTML='<img height="20" src="../img/add-icon.png"></img>';t.parentNode.innerHTML='<img id="star" height="20" src="../img/star-icon.png"></img>'}else{setNewErrorMessageListeLocalisation("Une erreur est survenu lors de la modification.")}}})}function modifierLocalisation(e,t){if(!localisationInUpdate){localisationInUpdate=true;idLocalisationToUpdate=e;var n=$("#tabSupprimer"+e).html('<a onclick="annulerLocalisation('+e+');">Annuler</a>');oldnom=$("#tabnom"+e).text();oldLongitude=$("#tablongitude"+e).text();oldLatitude=$("#tablatitude"+e).text();var r=$("#tabnom"+e).html('<input id="inputnom'+e+'" type="text" value="'+oldnom+'"/>');var i=$("#tablongitude"+e).html('<input id="inputlongitude'+e+'" type="text" value='+oldLongitude+"></input>");var s=$("#tablatitude"+e).html('<input id="inputlatitude'+e+'" type="text" value='+oldLatitude+"></input>")}else{var o=$("#inputnom"+e).val();var u=$("#inputlongitude"+e).val();var a=$("#inputlatitude"+e).val();$.ajax({url:"ajaxMethods/ajaxUpdateLocalisation.php",type:"POST",dataType:"text",data:{id:e,nom:o,longitude:u,latitude:a},/*timeout:1e3,*/error:function(){setNewErrorMessageListeLocalisation("Une erreur est survenu.")},success:function(t){if(t.indexOf("OK")!==-1){var n=$("#tabnom"+e).html('<p id="nom'+e+'">'+o+"</p>");var r=$("#tablongitude"+e).html('<p id="longitude'+e+'">'+u+"</p>");var i=$("#tablatitude"+e).html('<p id="latitude'+e+'">'+a+"</p>");var s=$("#tabSupprimer"+e).html('<a onclick="deleteLocalisation('+e+',this.parentNode)"><img src="../img/delete-icon.png"></img></a>');setNewSuccessMessageListeLocalisation("Modification bien éffectué.")}else if(t.indexOf("ERROR")!==-1){setNewErrorMessageListeLocalisation("Une erreur est survenu lors de la modification.")}}});localisationInUpdate=false}}function annulerLocalisation(e){var t=$("#tabnom"+e).html('<p id="nom'+e+'">'+oldnom+"</p>");var n=$("#tablongitude"+e).html('<p id="longitude'+e+'">'+oldLongitude+"</p>");var r=$("#tablatitude"+e).html('<p id="latitude'+e+'">'+oldLatitude+"</p>");var i=$("#tabSupprimer"+e).html('<a onclick="deleteLocalisation('+e+',this.parentNode)"><img src="../img/delete-icon.png"></img></a>');idProjetSelectedToUpdate="";isProjetInUpdate=false}var idSelectedToUpdate="";var isInUpdate=false;var nb=1;var idProjetSelectedToUpdate="";var isProjetInUpdate=false;var titreUp;var descriptionUp;window.closeModal=function(){$("#myModal2").modal("hide")};var localisationInUpdate=false;var idLocalisationToUpdate;var oldnom;var oldLongitude;var oldLatitude;(function(e,t,n,r,i,s,o){e["GoogleAnalyticsObject"]=i;e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date;s=t.createElement(n),o=t.getElementsByTagName(n)[0];s.async=1;s.src=r;o.parentNode.insertBefore(s,o)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-47421440-1","damienchesneau.fr");ga("send","pageview")
